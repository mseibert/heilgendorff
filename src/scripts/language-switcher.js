// Language Switcher Script
class LanguageSwitcher {
  constructor() {
    this.currentLanguage = this.getStoredLanguage() || 'de';
    this.translations = null;
    this.init();
  }

  async init() {
    // Load translations
    try {
      const response = await fetch('/src/locales.ts');
      const text = await response.text();
      // This is a simplified approach - in a real implementation you'd want to properly parse the TypeScript
      // For now, we'll use a simpler approach with inline translations
      this.translations = this.getInlineTranslations();
    } catch (error) {
      console.error('Error loading translations:', error);
      this.translations = this.getInlineTranslations();
    }

    this.setupEventListeners();
    this.updateLanguage(this.currentLanguage);
  }

  getInlineTranslations() {
    return {
      de: {
        home: "Home",
        clientArea: "Mandantenbereich",
        about: "√úber Uns",
        meetTheTeam: "Meet the Team",
        references: "Referenzen",
        ourTraining: "Unsere Weiterbildungen",
        services: "Leistungen",
        individuals: "Privatpersonen",
        entrepreneurs: "Unternehmer",
        career: "Karriere",
        contact: "Kontakt",
        news: "Aktuelles",
        datevNews: "Datev News",
        downloads: "Downloads",
        taxVideos: "Steuererkl√§rvideos",
        siteTitle: "Steuerb√ºro Heilgendorff",
        siteSubtitle: "Ihr zuverl√§ssiger Partner aus Wiesbaden",
        current: "Aktuelles",
        coronaRefunds: "Corona Sofortzur√ºckzahlungen",
        coronaText: "Informieren Sie sich √ºber die aktuellen Regelungen zu Corona Sofortzur√ºckzahlungen. Wir unterst√ºtzen Sie bei der korrekten Beantragung und Abwicklung aller notwendigen Formalit√§ten.",
        learnMore: "Mehr dazu",
        careerSection: "Karriere",
        careerTitle: "Bewerbung",
        careerText: "Werden Sie Teil unseres Teams! Wir suchen engagierte Steuerberater und Fachkr√§fte, die gemeinsam mit uns die Zukunft der Steuerberatung gestalten m√∂chten.",
        toCareerPage: "Zur Karriere-Seite",
        digital: "Digital",
        digitalText: "Papierlos gl√ºcklich und von √ºberall zu erreichen: Auch von der Ferne aus l√§uft die Kommunikation mit uns tadellos.",
        learnMoreAbout: "Mehr erfahren",
        international: "International",
        internationalText: "Wir beraten Sie in allen betriebswirtschaftlichen und steuerrechtlichen Fragen zum In- und Ausland",
        qualified: "Qualifiziert",
        qualifiedText: "Durch unsere stetige Teilnahme an zahlreichen Fortbildungen sind wir immer auf dem neuesten Stand.",
        aboutTitle: "√úber uns",
        aboutSubtitle: "Wir lieben es zu arbeiten & wir lieben, wo wir arbeiten",
        aboutText1: "Wir beraten Sie in allen betriebswirtschaftlichen und steuerrechtlichen Fragen. Unsere Fachgebiete sind die Steuererkl√§rungsberatung, die Steuerdurchsetzungsberatung und die gestaltende Steuerberatung.",
        aboutText2: "Steuerb√ºro Heilgendorff bietet seinen Mandanten zus√§tzlich den Zugriff auf den Terminalserver der Kanzlei, um die Kommunikation so einfach und komfortabel wie m√∂glich zu gestalten.",
        aboutText3: "Unsere Erfahrung mit unserem branchen√ºbergreifenden Leistungspektrum erm√∂glicht es uns, schnell und effizient Ihr Anliegen zu bearbeiten.",
        founderTitle: "Burghard Heilgendorff, Kanzleiinhaber",
        founderText: "Die Begleitung eines Unternehmens vom Startup √ºber alle Unternehmensphasen hinweg bietet f√ºr mich die gr√∂√üte Herausforderung. Der Mandant wird betreut von der Unternehmensgr√ºndung, dem Verm√∂gensaufbau bis zur Altersabsicherung und erbschaftsteuerlichen Gestaltung",
        languages: "Unser Sprachenrepertoire",
        german: "Deutsch",
        english: "Englisch",
        french: "Franz√∂sisch",
        teamText: "Unser Team stellt sich zusammen aus Steuerberatern, Steuerfachangestellten, Steuerfachwirten, Betriebswirten und Finanz- und Lohnbuchhaltern sowie Auszubildenden und studentischen Hilfskr√§ften. Zus√§tzlich unterst√ºtzen wir unsere Angestellten, Auszubildenden und Studenten, indem wir zahlreiche Fortbildungsma√ünahmen bieten und ein duales Studium erm√∂glichen.",
        clientAreaTitle: "Mandantenbereich",
        clientAreaSubtitle: "Ihr digitaler Zugang zu unseren Dienstleistungen",
        kanzleiDrive: "Kanzlei Drive",
        kanzleiDriveText: "F√ºr die digitale Zusammenarbeit mit unseren Mandanten setzen wir auf Kanzlei Drive ‚Äì eine sichere und benutzerfreundliche Plattform zum Austausch von Unterlagen und Informationen.",
        loginText: "√úber den folgenden Link gelangen Sie direkt zur Anmeldung:",
        loginButton: "üëâ Jetzt bei Kanzlei Drive anmelden",
        kanzleiDriveText2: "Mit Kanzlei Drive haben Sie jederzeit Zugriff auf Ihre Dokumente ‚Äì schnell, gesch√ºtzt und zuverl√§ssig.",
        navigation: "Navigation",
        ourCompany: "Unser Unternehmen",
        privacy: "Datenschutz",
        imprint: "Impressum",
        cookiePolicy: "Cookie-Richtlinie (EU)",
        contactInfo: "Kontakt",
        phone: "Telefon: +49 (0) 611 391320",
        email: "E-Mail: kontakt@heilgendorff.de",
        address: "Adresse: Unter den Eichen 7F, 65195 Wiesbaden",
        certifications: "Zertifizierungen",
        copyright: "Alle Rechte vorbehalten.",
        // Homepage specific translations
        heroTitle: "Steuerb√ºro Heilgendorff",
        heroSubtitle: "Ihr zuverl√§ssiger Partner aus Wiesbaden",
        uniqueTitle: "Was uns einzigartig macht",
        uniqueText: "Wir sind eine moderne Steuerberatungskanzlei mit √ºber 20 Jahren Erfahrung. Unser Team aus qualifizierten Steuerberatern und Fachkr√§ften steht Ihnen mit Kompetenz und Leidenschaft zur Seite.",
        testimonialsTitle: "Unsere zufriedenen Mandanten",
        testimonial1: "Seit Jahren vertraue ich dem Steuerb√ºro Heilgendorff meine Steuerangelegenheiten an. Die Beratung ist stets kompetent und die Abwicklung sehr professionell.",
        testimonial1Author: "Martin Seibert, Seibert Group GmbH",
        testimonial2: "Das Team von Heilgendorff hat uns bei der Unternehmensgr√ºndung hervorragend unterst√ºtzt. Besonders die digitale Zusammenarbeit funktioniert einwandfrei.",
        testimonial2Author: "Mario Becke, Becke Consulting",
        testimonial3: "Mit dem Steuerb√ºro Heilgendorff haben wir einen sehr zuverl√§ssigen, kompetenten und pragmatischen Partner zur Seite, der es uns als junges Unternehmen erm√∂glicht uns auf unsere Produkte und Kunden zu konzentrieren.",
        testimonial3Author: "Adil Nasri, Junovi UG",
        // Career page translations
        careerHeroTitle: "Karriere",
        careerHeroSubtitle: "Werden Sie Teil unseres Teams und gestalten Sie die Zukunft der Steuerberatung mit",
        careerIntro: "Wir sind eine modern eingerichtete Kanzlei mit 10 Mitarbeitern und beraten Mandanten aus allen Branchen. Unser Team stellt sich zusammen aus Steuerberatern, Steuerfachangestellten, Steuerfachwirten, Betriebswirten und Finanz- und Lohnbuchhaltern sowie Auszubildenden und studentischen Hilfskr√§ften.",
        careerIntro2: "Dabei nutzen wir die DATEV-Software und modernste Kommunikationsmittel. Da wir gro√üe Unterst√ºtzer der papierlosen B√ºrokratie sind, ist bei unseren Mandanten DATEV Unternehmen Online Standard.",
        careerHighlights: "Besondere Schwerpunkte legen wir auf:",
        careerHighlight1: "die Weiterbildung unserer Mitarbeiter",
        careerHighlight2: "ein gutes Arbeitsklima",
        careerHighlight3: "die M√∂glichkeit zur Selbstverwirklichung",
        careerHighlight4: "Aufstiegsm√∂glichkeiten",
        careerHighlight5: "die Digitalisierung unseres Unternehmens",
        jobOpenings: "Wir stellen ein:",
        applyNow: "Jetzt bewerben",
        // About page translations
        aboutHeroTitle: "√úber uns",
        aboutHeroSubtitle: "Erfahren Sie mehr √ºber unser Team, unsere Werte und unsere Leidenschaft f√ºr die Steuerberatung",
        // Contact page translations
        contactHeroTitle: "Kontakt",
        contactHeroSubtitle: "Kontaktieren Sie uns f√ºr eine pers√∂nliche Beratung",
        // Services page translations
        servicesHeroTitle: "Leistungen",
        servicesHeroSubtitle: "Umfassende Steuerberatung f√ºr Privatpersonen und Unternehmen",
        // News page translations
        newsHeroTitle: "Aktuelles",
        newsHeroSubtitle: "Aktuelle Informationen und Neuigkeiten aus der Steuerberatung"
      },
      en: {
        home: "Home",
        clientArea: "Client Area",
        about: "About Us",
        meetTheTeam: "Meet the Team",
        references: "References",
        ourTraining: "Our Training",
        services: "Services",
        individuals: "Individuals",
        entrepreneurs: "Entrepreneurs",
        career: "Career",
        contact: "Contact",
        news: "News",
        datevNews: "Datev News",
        downloads: "Downloads",
        taxVideos: "Tax Explanation Videos",
        siteTitle: "Heilgendorff Tax Office",
        siteSubtitle: "Your reliable partner from Wiesbaden",
        current: "Current",
        coronaRefunds: "Corona Emergency Refunds",
        coronaText: "Find out about the current regulations for Corona emergency refunds. We support you with the correct application and processing of all necessary formalities.",
        learnMore: "Learn more",
        careerSection: "Career",
        careerTitle: "Application",
        careerText: "Become part of our team! We are looking for committed tax advisors and specialists who want to shape the future of tax consulting together with us.",
        toCareerPage: "To Career Page",
        digital: "Digital",
        digitalText: "Paperless and happy, reachable from anywhere: Even from a distance, communication with us runs flawlessly.",
        learnMoreAbout: "Learn more",
        international: "International",
        internationalText: "We advise you on all business and tax law questions for domestic and international matters",
        qualified: "Qualified",
        qualifiedText: "Through our continuous participation in numerous training courses, we are always up to date.",
        aboutTitle: "About us",
        aboutSubtitle: "We love to work & we love where we work",
        aboutText1: "We advise you on all business and tax law questions. Our areas of expertise are tax return consulting, tax enforcement consulting and tax planning consulting.",
        aboutText2: "Heilgendorff Tax Office offers its clients additional access to the law firm's terminal server to make communication as simple and comfortable as possible.",
        aboutText3: "Our experience with our cross-industry range of services enables us to process your concerns quickly and efficiently.",
        founderTitle: "Burghard Heilgendorff, Law Firm Owner",
        founderText: "Accompanying a company from startup through all company phases offers me the greatest challenge. The client is supported from company formation, asset building to retirement planning and inheritance tax structuring",
        languages: "Our Language Repertoire",
        german: "German",
        english: "English",
        french: "French",
        teamText: "Our team consists of tax advisors, tax assistants, tax specialists, business economists and financial and payroll accountants as well as trainees and student assistants. In addition, we support our employees, trainees and students by offering numerous training measures and enabling dual studies.",
        clientAreaTitle: "Client Area",
        clientAreaSubtitle: "Your digital access to our services",
        kanzleiDrive: "Kanzlei Drive",
        kanzleiDriveText: "For digital collaboration with our clients, we rely on Kanzlei Drive ‚Äì a secure and user-friendly platform for exchanging documents and information.",
        loginText: "Via the following link you can log in directly:",
        loginButton: "üëâ Log in to Kanzlei Drive now",
        kanzleiDriveText2: "With Kanzlei Drive you have access to your documents at any time ‚Äì fast, secure and reliable.",
        navigation: "Navigation",
        ourCompany: "Our Company",
        privacy: "Privacy",
        imprint: "Imprint",
        cookiePolicy: "Cookie Policy (EU)",
        contactInfo: "Contact",
        phone: "Phone: +49 (0) 611 391320",
        email: "Email: kontakt@heilgendorff.de",
        address: "Address: Unter den Eichen 7F, 65195 Wiesbaden",
        certifications: "Certifications",
        copyright: "All rights reserved.",
        // Homepage specific translations
        heroTitle: "Heilgendorff Tax Office",
        heroSubtitle: "Your reliable partner from Wiesbaden",
        uniqueTitle: "What makes us unique",
        uniqueText: "We are a modern tax consulting firm with over 20 years of experience. Our team of qualified tax advisors and specialists is at your side with competence and passion.",
        testimonialsTitle: "Our satisfied clients",
        testimonial1: "For years I have trusted Heilgendorff Tax Office with my tax matters. The advice is always competent and the processing very professional.",
        testimonial1Author: "Martin Seibert, Seibert Group GmbH",
        testimonial2: "The Heilgendorff team supported us excellently in setting up the company. The digital collaboration works particularly well.",
        testimonial2Author: "Mario Becke, Becke Consulting",
        testimonial3: "With Heilgendorff Tax Office we have a very reliable, competent and pragmatic partner at our side who enables us as a young company to focus on our products and customers.",
        testimonial3Author: "Adil Nasri, Junovi UG",
        // Career page translations
        careerHeroTitle: "Career",
        careerHeroSubtitle: "Become part of our team and help shape the future of tax consulting",
        careerIntro: "We are a modern law firm with 10 employees and advise clients from all industries. Our team consists of tax advisors, tax assistants, tax specialists, business economists and financial and payroll accountants as well as trainees and student assistants.",
        careerIntro2: "We use DATEV software and the most modern communication tools. Since we are big supporters of paperless bureaucracy, DATEV Unternehmen Online is standard for our clients.",
        careerHighlights: "We place particular emphasis on:",
        careerHighlight1: "the further training of our employees",
        careerHighlight2: "a good working atmosphere",
        careerHighlight3: "the possibility for self-realization",
        careerHighlight4: "career opportunities",
        careerHighlight5: "the digitalization of our company",
        jobOpenings: "We are hiring:",
        applyNow: "Apply now",
        // About page translations
        aboutHeroTitle: "About us",
        aboutHeroSubtitle: "Learn more about our team, our values and our passion for tax consulting",
        // Contact page translations
        contactHeroTitle: "Contact",
        contactHeroSubtitle: "Contact us for personal advice",
        // Services page translations
        servicesHeroTitle: "Services",
        servicesHeroSubtitle: "Comprehensive tax consulting for individuals and companies",
        // News page translations
        newsHeroTitle: "News",
        newsHeroSubtitle: "Current information and news from tax consulting"
      }
    };
  }

  setupEventListeners() {
    const deButton = document.querySelector('.lang-button[data-lang="de"]');
    const enButton = document.querySelector('.lang-button[data-lang="en"]');
    
    if (deButton) {
      deButton.addEventListener('click', () => this.switchLanguage('de'));
    }
    
    if (enButton) {
      enButton.addEventListener('click', () => this.switchLanguage('en'));
    }
  }

  switchLanguage(lang) {
    this.currentLanguage = lang;
    this.storeLanguage(lang);
    this.updateLanguage(lang);
  }

  updateLanguage(lang) {
    if (!this.translations || !this.translations[lang]) return;

    const t = this.translations[lang];
    
    // Update all elements with data-translate attribute
    document.querySelectorAll('[data-translate]').forEach(element => {
      const key = element.getAttribute('data-translate');
      if (t[key]) {
        element.textContent = t[key];
      }
    });

    // Update language buttons
    document.querySelectorAll('.lang-button').forEach(button => {
      button.classList.remove('active');
    });
    
    const activeButton = document.querySelector(`.lang-button[data-lang="${lang}"]`);
    if (activeButton) {
      activeButton.classList.add('active');
    }
  }

  getStoredLanguage() {
    return localStorage.getItem('language') || 'de';
  }

  storeLanguage(lang) {
    localStorage.setItem('language', lang);
  }
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  new LanguageSwitcher();
});

