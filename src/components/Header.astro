---
import { SITE_TITLE } from '../consts';
import HeaderLink from './HeaderLink.astro';
import { Image } from 'astro:assets';
import Logo from '../assets/images/logo.png';
---

<header>
	<nav class="navbar">
		<div class="nav-container">
			<!-- Logo -->
			<div class="logo">
				<a href="/">
					<Image src={Logo} alt="Heilgendorff Logo" class="logo-image" width={200} height={50} />
				</a>
			</div>
			
			<!-- Mobile Hamburger Button -->
			<button class="mobile-toggle" id="mobileToggle" aria-label="Toggle mobile menu">
				<span class="hamburger-line"></span>
				<span class="hamburger-line"></span>
				<span class="hamburger-line"></span>
			</button>

			<!-- Desktop Navigation -->
			<div class="desktop-nav">
				<ul class="nav-menu">
					<li class="nav-item">
					<HeaderLink href="/" data-translate="home">Home</HeaderLink>
					</li>
					<li class="nav-item">
					<HeaderLink href="/mandantenbereich" data-translate="clientArea">Mandantenbereich</HeaderLink>
					</li>
					<li class="nav-item dropdown">
						<a href="/about" class="nav-link dropdown-toggle" data-translate="about">
							Über Uns
							<span class="dropdown-arrow">▼</span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/meet-the-team" data-translate="meetTheTeam">Meet the Team</a></li>
							<li><a href="/referenzen" data-translate="references">Referenzen</a></li>
							<li><a href="/unsere-weiterbildungen" data-translate="ourTraining">Unsere Weiterbildungen</a></li>
						</ul>
					</li>
					<li class="nav-item dropdown">
						<a href="/leistungen" class="nav-link dropdown-toggle" data-translate="services">
							Leistungen
							<span class="dropdown-arrow">▼</span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/privatpersonen" data-translate="individuals">Privatpersonen</a></li>
							<li><a href="/unternehmer" data-translate="entrepreneurs">Unternehmer</a></li>
						</ul>
					</li>
					<li class="nav-item">
					<HeaderLink href="/karriere" data-translate="career">Karriere</HeaderLink>
					</li>
					<li class="nav-item">
					<HeaderLink href="/kontakt" data-translate="contact">Kontakt</HeaderLink>
					</li>
					<li class="nav-item dropdown">
						<a href="/aktuelles" class="nav-link dropdown-toggle" data-translate="news">
							Aktuelles
							<span class="dropdown-arrow">▼</span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/aktuelles" data-translate="datevNews">News</a></li>
							<li><a href="/downloads" data-translate="downloads">Downloads</a></li>
						</ul>
					</li>
				</ul>
				
				<div class="nav-actions">
					<div class="phone-number">
						<a href="tel:+496113913200">+49 (0) 611 3913200</a>
					</div>
					<div class="language-switcher">
						<button class="lang-btn active" data-lang="de">DE</button>
						<button class="lang-btn" data-lang="en">ENG</button>
					</div>
				</div>
			</div>
		</div>
	</nav>

	<!-- Mobile Navigation -->
			<div class="mobile-nav" id="mobileNav">
				<div class="mobile-nav-content">
			<ul class="mobile-menu">
				<li><a href="/" class="mobile-link" data-translate="home">Home</a></li>
				<li><a href="/mandantenbereich" class="mobile-link" data-translate="clientArea">Mandantenbereich</a></li>
				
				<li class="mobile-dropdown">
					<div class="mobile-dropdown-header">
						<a href="/about" class="mobile-link mobile-main-link" data-translate="about">Über Uns</a>
						<button class="mobile-dropdown-toggle" aria-label="Toggle dropdown">
							<span class="mobile-arrow">▼</span>
						</button>
					</div>
					<ul class="mobile-dropdown-menu">
						<li><a href="/meet-the-team" class="mobile-link" data-translate="meetTheTeam">Meet the Team</a></li>
						<li><a href="/referenzen" class="mobile-link" data-translate="references">Referenzen</a></li>
						<li><a href="/unsere-weiterbildungen" class="mobile-link" data-translate="ourTraining">Unsere Weiterbildungen</a></li>
					</ul>
				</li>
				
				<li class="mobile-dropdown">
					<div class="mobile-dropdown-header">
						<a href="/leistungen" class="mobile-link mobile-main-link" data-translate="services">Leistungen</a>
						<button class="mobile-dropdown-toggle" aria-label="Toggle dropdown">
							<span class="mobile-arrow">▼</span>
						</button>
					</div>
					<ul class="mobile-dropdown-menu">
						<li><a href="/privatpersonen" class="mobile-link" data-translate="individuals">Privatpersonen</a></li>
						<li><a href="/unternehmer" class="mobile-link" data-translate="entrepreneurs">Unternehmer</a></li>
					</ul>
				</li>
				
				<li><a href="/karriere" class="mobile-link" data-translate="career">Karriere</a></li>
				<li><a href="/kontakt" class="mobile-link" data-translate="contact">Kontakt</a></li>
				
				<li class="mobile-dropdown">
					<div class="mobile-dropdown-header">
						<a href="/aktuelles" class="mobile-link mobile-main-link" data-translate="news">Aktuelles</a>
						<button class="mobile-dropdown-toggle" aria-label="Toggle dropdown">
							<span class="mobile-arrow">▼</span>
						</button>
					</div>
					<ul class="mobile-dropdown-menu">
						<li><a href="/aktuelles" class="mobile-link" data-translate="datevNews">News</a></li>
						<li><a href="/downloads" class="mobile-link" data-translate="downloads">Downloads</a></li>
					</ul>
				</li>
			</ul>
			
			<div class="mobile-actions">
						<div class="mobile-phone">
							<a href="tel:+496113913200">+49 (0) 611 3913200</a>
						</div>
						<div class="mobile-language-switcher">
					<button class="lang-btn active" data-lang="de">DE</button>
					<button class="lang-btn" data-lang="en">ENG</button>
						</div>
					</div>
				</div>
			</div>
</header>

<style>
	/* Reset und Basis-Styles */
	* {
		box-sizing: border-box;
	}

	/* Header Container */
	header {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		background: white;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
		z-index: 1000;
		width: 100%;
		height: 70px;
	}

	.navbar {
		width: 100%;
	}

	.nav-container {
		max-width: 1400px;
		margin: 0 auto;
		padding: 0 2rem;
		display: flex;
		align-items: center;
		justify-content: space-between;
		height: 70px;
		width: 100%;
	}

	/* Logo */
	.logo {
		display: flex;
		align-items: center;
	}

	.logo a {
		text-decoration: none;
	}

	.logo-image {
		height: 40px;
		width: auto;
		max-width: 150px;
	}

	/* Mobile Toggle Button */
	.mobile-toggle {
		display: none;
		flex-direction: column;
		justify-content: space-around;
		width: 30px;
		height: 30px;
		background: transparent;
		border: none;
		cursor: pointer;
		padding: 0;
		z-index: 1001;
	}

	.hamburger-line {
		width: 100%;
		height: 3px;
		background: var(--accent);
		transition: all 0.3s ease;
		transform-origin: center;
	}

	.mobile-toggle.active .hamburger-line:nth-child(1) {
		transform: rotate(45deg) translate(6px, 6px);
	}

	.mobile-toggle.active .hamburger-line:nth-child(2) {
		opacity: 0;
	}

	.mobile-toggle.active .hamburger-line:nth-child(3) {
		transform: rotate(-45deg) translate(6px, -6px);
	}

	/* Desktop Navigation */
	.desktop-nav {
		display: flex;
		align-items: center;
		gap: 1rem;
		flex: 1;
		justify-content: center;
	}

	.nav-menu {
		display: flex;
		list-style: none;
		margin: 0;
		padding: 0;
		gap: 0.2rem;
		align-items: center;
		height: 70px;
	}

	.nav-item {
		position: relative;
		display: flex;
		align-items: center;
		height: 70px;
		margin: 0;
		padding: 0;
	}

	/* Alle Navigation Links - exakt gleiche Höhe und Ausrichtung */
	.nav-item > a,
	.nav-item > HeaderLink,
	.nav-link {
		display: flex !important;
		align-items: center !important;
		justify-content: center !important;
		height: 70px !important;
		padding: 0 0.8rem !important;
		margin: 0 !important;
		box-sizing: border-box !important;
		font-family: "IBM Plex Sans", sans-serif !important;
		font-size: 1rem !important;
		font-weight: 500 !important;
		line-height: 1.2 !important;
		text-decoration: none !important;
		transition: all 0.3s ease !important;
		color: var(--accent) !important;
		border-bottom: 3px solid transparent !important;
		white-space: nowrap !important;
		vertical-align: middle !important;
		position: relative !important;
		top: 0 !important;
	}

	.nav-link {
		gap: 0.3rem;
	}

	/* Dropdown-Pfeile sollen die Ausrichtung nicht beeinträchtigen */
	.dropdown-arrow {
		display: inline-flex !important;
		align-items: center !important;
		vertical-align: middle !important;
		line-height: 1 !important;
		margin: 0 !important;
		margin-left: 0.3rem !important;
	}

	.nav-item > a:hover,
	.nav-link:hover {
		color: var(--accent) !important;
		border-bottom-color: var(--accent) !important;
		font-weight: 600 !important;
	}

	/* Dropdown Styles */
	.dropdown {
		position: relative;
	}

	.dropdown-toggle {
		cursor: pointer;
	}

	.dropdown-arrow {
		font-size: 0.8rem !important;
		opacity: 1 !important;
		transition: transform 0.3s ease !important;
		display: inline-block !important;
		margin-left: 0.5rem !important;
		vertical-align: middle !important;
		line-height: 1 !important;
		color: var(--accent) !important;
		font-weight: bold !important;
		visibility: visible !important;
	}

	.dropdown:hover .dropdown-arrow {
		transform: rotate(180deg) !important;
	}

	/* Override any conflicting styles for dropdown arrows */
	span.dropdown-arrow {
		opacity: 1 !important;
		display: inline-block !important;
		visibility: visible !important;
		font-size: 0.8rem !important;
		margin-left: 0.5rem !important;
		color: var(--accent) !important;
		font-weight: bold !important;
		transition: transform 0.3s ease !important;
		vertical-align: middle !important;
		line-height: 1 !important;
	}

	/* Ensure dropdown arrows are always visible */
	.nav-link .dropdown-arrow,
	.dropdown-toggle .dropdown-arrow,
	.nav-menu a .dropdown-arrow,
	.nav-menu .nav-link .dropdown-arrow {
		opacity: 1 !important;
		display: inline-block !important;
		visibility: visible !important;
		font-size: 0.8rem !important;
		margin-left: 0.5rem !important;
		color: var(--accent) !important;
		font-weight: bold !important;
		transition: transform 0.3s ease !important;
	}

	.dropdown-menu {
		position: absolute;
		top: 100%;
		left: 0;
		background: white;
		min-width: 220px;
		box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
		border-radius: 8px;
		border: 1px solid #e5e7eb;
		opacity: 0;
		visibility: hidden;
		transform: translateY(-10px);
		transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		pointer-events: none;
		z-index: 1001;
		list-style: none;
		margin: 0;
		padding: 0.5rem 0;
		overflow: hidden;
	}

	.dropdown:hover .dropdown-menu {
		opacity: 1;
		visibility: visible;
		transform: translateY(0);
		pointer-events: auto;
	}

	.dropdown-menu li {
		margin: 0;
	}

	.dropdown-menu a {
		display: block;
		padding: 12px 20px;
		color: #374151;
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-size: 0.95rem;
		font-weight: 500;
		transition: all 0.2s ease;
		border-bottom: 1px solid #e5e7eb;
		position: relative;
	}

	.dropdown-menu li:last-child a {
		border-bottom: 1px solid #e5e7eb;
	}

	.dropdown-menu li:last-child a:hover {
		border-bottom: 2px solid var(--accent);
	}

	.dropdown-menu a:hover {
		background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
		color: var(--accent);
		padding-left: 24px;
		border-bottom: 2px solid var(--accent);
	}

	.dropdown-menu a:hover::before {
		content: '';
		position: absolute;
		left: 0;
		top: 0;
		bottom: 0;
		width: 3px;
		background: var(--accent);
	}

	/* Navigation Actions */
	.nav-actions {
		display: flex;
		align-items: center;
		gap: 1rem;
		flex-shrink: 0;
		margin-left: 1rem;
	}

	.phone-number a {
		color: var(--accent);
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-weight: 600;
		font-size: 1rem;
		transition: color 0.3s ease;
	}

	.phone-number a:hover {
		color: var(--accent-dark);
	}

	.language-switcher {
		display: flex;
		border: 1px solid #d0d0d0;
		border-radius: 4px;
		overflow: hidden;
		background: white;
	}

	.lang-btn {
		background: white;
		border: none;
		padding: 0.5rem 0.8rem;
		cursor: pointer;
		font-family: "IBM Plex Sans", sans-serif;
		font-size: 0.9rem;
		font-weight: 500;
		transition: all 0.3s ease;
		color: #374151;
	}

	.lang-btn:hover {
		background: #f8fafc;
	}

	.lang-btn.active {
		background: var(--accent);
		color: white;
	}

	/* Mobile Navigation */
	.mobile-nav {
		display: none;
		position: fixed;
		top: 70px;
		left: 0;
		right: 0;
		background: white;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
		z-index: 999;
		max-height: calc(100vh - 70px);
		overflow-y: auto;
	}

	@media (max-width: 1024px) {
		.mobile-nav {
			top: 60px;
			max-height: calc(100vh - 60px);
		}
	}

	.mobile-nav.active {
		display: block;
	}

	.mobile-nav-content {
		padding: 2rem;
	}

	.mobile-menu {
		list-style: none;
		margin: 0;
		padding: 0;
			display: flex;
		flex-direction: column;
		gap: 0.5rem;
		margin-bottom: 2rem;
	}

	.mobile-menu li {
		margin: 0;
	}

	.mobile-link {
		display: block;
		padding: 1rem 0;
		color: var(--black);
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-size: 1.1rem;
		font-weight: 500;
		border-bottom: 1px solid #e0e0e0;
		transition: color 0.3s ease;
	}

	.mobile-link:hover {
		color: var(--accent);
	}

	.mobile-dropdown {
		display: flex;
		flex-direction: column;
	}

	.mobile-dropdown-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		border-bottom: 1px solid #e0e0e0;
	}

	.mobile-main-link {
		flex: 1;
		padding: 1rem 0;
		margin: 0;
		border-bottom: none !important;
	}

	.mobile-dropdown-toggle {
		display: flex;
		align-items: center;
		justify-content: center;
		padding: 1rem;
		background: none;
		border: none;
		color: var(--black);
		cursor: pointer;
		transition: color 0.3s ease;
		min-width: 44px;
		min-height: 44px;
		touch-action: manipulation;
		-webkit-tap-highlight-color: transparent;
	}

	.mobile-dropdown-toggle:hover,
	.mobile-dropdown-toggle:active {
		color: var(--accent);
		background: rgba(0, 0, 0, 0.05);
	}

	.mobile-arrow {
		transition: transform 0.3s ease;
		font-size: 0.8rem;
		opacity: 1 !important;
		display: inline-block !important;
		margin: 0;
		color: var(--accent);
		font-weight: bold;
	}

	.mobile-dropdown.active .mobile-arrow {
		transform: rotate(180deg);
	}

	.mobile-dropdown-menu {
		display: none;
		list-style: none;
		margin: 0;
		padding: 0;
		padding-left: 1rem;
	}

	.mobile-dropdown.active .mobile-dropdown-menu {
		display: block;
	}

	.mobile-dropdown-menu .mobile-link {
		padding: 0.8rem 0;
		font-size: 1rem;
		border-bottom: 1px solid #e5e7eb;
		transition: all 0.2s ease;
		display: block;
		color: #374151;
		text-decoration: none;
	}

	.mobile-dropdown-menu .mobile-link:hover {
		color: var(--accent);
		border-bottom: 2px solid var(--accent);
	}

	.mobile-actions {
			display: flex;
		flex-direction: column;
		gap: 1.5rem;
		align-items: center;
		padding-top: 1rem;
		border-top: 1px solid #e0e0e0;
	}

	.mobile-phone a {
		color: var(--accent);
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-weight: 600;
		font-size: 1.1rem;
	}

	.mobile-language-switcher {
		display: flex;
		border: 1px solid #e0e0e0;
		border-radius: 4px;
		overflow: hidden;
	}

	/* Responsive Design */
	/* Tablet and Mobile - use mobile navigation */
	@media (max-width: 1024px) {
		.desktop-nav {
			display: none;
		}

		.mobile-toggle {
			display: flex;
		}

		header {
			height: 60px;
		}

		.nav-container {
			padding: 0 1.5rem;
			height: 60px;
			max-width: 100%;
		}

		.logo-image {
			height: 32px;
			max-width: 110px;
		}
	}

	@media (max-width: 768px) {
		.nav-container {
			padding: 0 1rem;
		}

		.logo-image {
			height: 35px;
		}
	}

	@media (max-width: 480px) {
		.nav-container {
			padding: 0 0.5rem;
		}

		.mobile-nav-content {
			padding: 1rem;
		}
	}
</style>

<script is:inline>
	// Mobile Menu Toggle
document.addEventListener('DOMContentLoaded', function() {
		const mobileToggle = document.getElementById('mobileToggle');
		const mobileNav = document.getElementById('mobileNav');
		const mobileDropdowns = document.querySelectorAll('.mobile-dropdown');

		// Toggle mobile menu
		if (mobileToggle && mobileNav) {
			mobileToggle.addEventListener('click', function(e) {
				e.preventDefault();
				e.stopPropagation();
				mobileToggle.classList.toggle('active');
				mobileNav.classList.toggle('active');
			});
			
			// Also support touch events for better mobile compatibility
			mobileToggle.addEventListener('touchend', function(e) {
				e.preventDefault();
				e.stopPropagation();
				mobileToggle.classList.toggle('active');
				mobileNav.classList.toggle('active');
			});
		}

		// Mobile dropdown toggles
		mobileDropdowns.forEach(dropdown => {
			const toggle = dropdown.querySelector('.mobile-dropdown-toggle');
			if (toggle) {
				toggle.addEventListener('click', function(e) {
					e.preventDefault();
					e.stopPropagation();
					dropdown.classList.toggle('active');
				});
				
				// Also support touch events
				toggle.addEventListener('touchend', function(e) {
					e.preventDefault();
					e.stopPropagation();
					dropdown.classList.toggle('active');
				});
			}
		});

		// Close mobile menu when clicking outside
		document.addEventListener('click', function(event) {
			if (mobileNav && mobileToggle && event.target instanceof Node) {
				if (!mobileNav.contains(event.target) && !mobileToggle.contains(event.target)) {
					mobileNav.classList.remove('active');
					mobileToggle.classList.remove('active');
				}
			}
		});

		// Language switcher is now handled globally in BaseHead.astro
	});
</script>
