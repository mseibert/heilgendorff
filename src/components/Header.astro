---
import { SITE_TITLE } from '../consts';
import HeaderLink from './HeaderLink.astro';
import { Image } from 'astro:assets';
import Logo from '../assets/images/logo.png';
---

<header>
	<nav>
		<div class="nav-content">
			<div class="logo">
				<a href="/">
					<Image src={Logo} alt="Heilgendorff Logo" class="logo-image" width={200} height={50} />
				</a>
			</div>
			
			<!-- Mobile Hamburger Button -->
			<button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle mobile menu">
				<span class="hamburger-line"></span>
				<span class="hamburger-line"></span>
				<span class="hamburger-line"></span>
			</button>

			<!-- Desktop Navigation -->
			<div class="desktop-nav">
				<div class="internal-links">
					<HeaderLink href="/" data-translate="home">Home</HeaderLink>
					<HeaderLink href="/mandantenbereich" data-translate="clientArea">Mandantenbereich</HeaderLink>
					<div class="dropdown">
						<HeaderLink href="/about" data-translate="about">Über Uns <span class="arrow">▼</span></HeaderLink>
						<div class="dropdown-content">
							<a href="/meet-the-team" data-translate="meetTheTeam">Meet the Team</a>
							<a href="/referenzen" data-translate="references">Referenzen</a>
							<a href="/unsere-weiterbildungen" data-translate="ourTraining">Unsere Weiterbildungen</a>
						</div>
					</div>
					<div class="dropdown">
						<HeaderLink href="/leistungen" data-translate="services">Leistungen <span class="arrow">▼</span></HeaderLink>
						<div class="dropdown-content">
							<a href="/privatpersonen" data-translate="individuals">Privatpersonen</a>
							<a href="/unternehmer" data-translate="entrepreneurs">Unternehmer</a>
						</div>
					</div>
					<HeaderLink href="/karriere" data-translate="career">Karriere</HeaderLink>
					<HeaderLink href="/kontakt" data-translate="contact">Kontakt</HeaderLink>
					<div class="dropdown">
						<HeaderLink href="/aktuelles" data-translate="news">Aktuelles <span class="arrow">▼</span></HeaderLink>
						<div class="dropdown-content">
							<a href="/datev-news" data-translate="datevNews">Datev News</a>
							<a href="/downloads" data-translate="downloads">Downloads</a>
							<a href="/steuererklärvideos" data-translate="taxVideos">Steuererklärvideos</a>
						</div>
					</div>
					<div class="phone-number">
						<a href="tel:+496113913200">+49 (0) 611 3913200</a>
					</div>
				</div>
				<div class="header-right">
					<div class="language-switcher">
						<button class="lang-button active" data-lang="de">DE</button>
						<button class="lang-button" data-lang="en">ENG</button>
					</div>
				</div>
			</div>

			<!-- Mobile Navigation Menu -->
			<div class="mobile-nav" id="mobileNav">
				<div class="mobile-nav-content">
					<div class="mobile-links">
						<a href="/" data-translate="home" class="mobile-link">Home</a>
						<a href="/mandantenbereich" data-translate="clientArea" class="mobile-link">Mandantenbereich</a>
						
						<div class="mobile-dropdown">
							<button class="mobile-dropdown-toggle" data-translate="about">Über Uns <span class="mobile-arrow">⌄</span></button>
							<div class="mobile-dropdown-content">
								<a href="/about" data-translate="about" class="mobile-link">Über Uns</a>
								<a href="/meet-the-team" data-translate="meetTheTeam" class="mobile-link">Meet the Team</a>
								<a href="/referenzen" data-translate="references" class="mobile-link">Referenzen</a>
								<a href="/unsere-weiterbildungen" data-translate="ourTraining" class="mobile-link">Unsere Weiterbildungen</a>
							</div>
						</div>

						<div class="mobile-dropdown">
							<button class="mobile-dropdown-toggle" data-translate="services">Leistungen <span class="mobile-arrow">⌄</span></button>
							<div class="mobile-dropdown-content">
								<a href="/leistungen" data-translate="services" class="mobile-link">Leistungen</a>
								<a href="/privatpersonen" data-translate="individuals" class="mobile-link">Privatpersonen</a>
								<a href="/unternehmer" data-translate="entrepreneurs" class="mobile-link">Unternehmer</a>
							</div>
						</div>

						<a href="/karriere" data-translate="career" class="mobile-link">Karriere</a>
						<a href="/kontakt" data-translate="contact" class="mobile-link">Kontakt</a>
						
						<div class="mobile-dropdown">
							<button class="mobile-dropdown-toggle" data-translate="news">Aktuelles <span class="mobile-arrow">⌄</span></button>
							<div class="mobile-dropdown-content">
								<a href="/aktuelles" data-translate="news" class="mobile-link">Aktuelles</a>
								<a href="/datev-news" data-translate="datevNews" class="mobile-link">Datev News</a>
								<a href="/downloads" data-translate="downloads" class="mobile-link">Downloads</a>
								<a href="/steuererklärvideos" data-translate="taxVideos" class="mobile-link">Steuererklärvideos</a>
							</div>
						</div>
					</div>
					
					<div class="mobile-header-right">
						<div class="mobile-phone">
							<a href="tel:+496113913200">+49 (0) 611 3913200</a>
						</div>
						<div class="mobile-language-switcher">
							<button class="lang-button active" data-lang="de">DE</button>
							<button class="lang-button" data-lang="en">ENG</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</nav>
</header>
<style>
	header {
		margin: 0;
		padding: 0;
		background: white;
		box-shadow: 0 2px 8px rgba(var(--black), 5%);
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		z-index: 10000;
		width: 100vw;
		overflow-x: hidden;
	}
	
	.logo {
		display: flex;
		align-items: center;
		justify-content: center;
		margin-left: 0;
	}

	.logo-image {
		height: 30px;
		width: auto;
		max-width: 120px;
		margin-top: 10px;
		transform: translateY(-3px);
	}

	.logo a {
		text-decoration: none;
		border-bottom: 4px solid transparent;
	}
	
	.logo a:hover {
		border-bottom-color: transparent !important;
	}

	nav {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 100%;
		margin: auto;
		padding: 0.4rem 2rem;
		height: 57px;
		box-sizing: border-box;
	}

	.nav-content {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 100%;
		gap: 0;
		position: relative;
	}

	.desktop-nav {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 100%;
		gap: 0;
		height: 57px;
	}

	.mobile-menu-toggle {
		display: none;
		flex-direction: column;
		justify-content: space-around;
		width: 30px;
		height: 30px;
		background: transparent;
		border: none;
		cursor: pointer;
		padding: 0;
		z-index: 1001;
		position: absolute;
		right: 3rem;
		top: 50%;
		transform: translateY(-50%);
	}

	.hamburger-line {
		width: 100%;
		height: 3px;
		background: var(--accent);
		transition: all 0.3s ease;
		transform-origin: center;
	}

	.mobile-menu-toggle.active .hamburger-line:nth-child(1) {
		transform: rotate(45deg) translate(6px, 6px);
	}

	.mobile-menu-toggle.active .hamburger-line:nth-child(2) {
		opacity: 0;
	}

	.mobile-menu-toggle.active .hamburger-line:nth-child(3) {
		transform: rotate(-45deg) translate(6px, -6px);
	}

	.mobile-nav {
		display: none;
		position: fixed;
		top: 57px;
		left: 50%;
		transform: translateX(-50%);
		width: 80vw;
		background: white;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
		z-index: 1000;
		max-height: calc(100vh - 50px);
		overflow-y: auto;
		border-radius: 0 0 12px 12px;
	}

	.mobile-nav.active {
		display: block;
	}

	.mobile-nav-content {
		padding: 2rem;
	}

	.mobile-links {
		display: flex;
		flex-direction: column;
		gap: 1rem;
		margin-bottom: 2rem;
	}

	.mobile-link {
		display: block;
		padding: 1rem 0;
		color: var(--black);
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-size: 1.1em;
		border-bottom: 1px solid #e0e0e0;
		transition: color 0.3s ease;
	}

	.mobile-link:hover {
		color: var(--accent);
	}

	.mobile-dropdown {
		display: flex;
		flex-direction: column;
	}

	.mobile-dropdown-toggle {
		display: flex;
		justify-content: space-between;
		align-items: center;
		padding: 1rem 0;
		background: none;
		border: none;
		color: var(--black);
		font-family: "IBM Plex Sans", sans-serif;
		font-size: 1.1em;
		cursor: pointer;
		border-bottom: 1px solid #e0e0e0;
		transition: color 0.3s ease;
	}

	.mobile-dropdown-toggle:hover {
		color: var(--accent);
	}

	.mobile-arrow {
		transition: transform 0.3s ease;
	}

	.mobile-dropdown.active .mobile-arrow {
		transform: rotate(180deg);
	}

	.mobile-dropdown-content {
		display: none;
		flex-direction: column;
		padding-left: 1rem;
	}

	.mobile-dropdown.active .mobile-dropdown-content {
		display: flex;
	}

	.mobile-dropdown-content .mobile-link {
		padding: 0.8rem 0;
		font-size: 1em;
		border-bottom: 1px solid #f0f0f0;
	}

	.mobile-header-right {
		display: flex;
		flex-direction: column;
		gap: 1.5rem;
		align-items: center;
		padding-top: 1rem;
		border-top: 1px solid #e0e0e0;
	}

	.mobile-phone a {
		color: var(--accent);
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-weight: 500;
		font-size: 1.1em;
	}

	.mobile-language-switcher {
		display: flex;
		border: 1px solid #e0e0e0;
		border-radius: 4px;
		overflow: hidden;
	}
	
	nav a {
		font-family: "IBM Plex Sans", sans-serif;
		font-size: 1.1rem;
		font-weight: 500;
		padding: 0.7em 0.8em;
		color: var(--black);
		border-bottom: 4px solid transparent;
		text-decoration: none;
		transition: all 0.3s ease;
		display: flex;
		align-items: center;
		height: 55px;
	}
	
	nav a:hover {
		color: var(--accent);
		border-bottom-color: var(--accent);
		font-weight: 700;
	}
	
	nav a.active,
	nav .active {
		text-decoration: none !important;
		border-bottom-color: var(--accent) !important;
		color: var(--accent) !important;
		font-weight: 700;
	}

	.internal-links {
		display: flex;
		gap: 0.5rem;
		flex-wrap: nowrap;
		justify-content: center;
		align-items: center;
		height: 55px;
	}

	.phone-number {
		margin-left: 1rem;
	}

	/* Desktop Dropdown Styles */
	.dropdown {
		position: relative;
		display: inline-block;
	}

	.dropdown a {
		color: var(--black);
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-weight: 500;
		font-size: 1.1rem;
		transition: all 0.3s ease;
		padding: 0.7em 0.8em;
		display: flex;
		align-items: center;
		height: 57px;
		white-space: nowrap;
		gap: 0.3em;
		border-bottom: 4px solid transparent;
	}

	.dropdown:hover a {
		color: var(--accent);
		border-bottom-color: var(--accent);
		font-weight: 700;
	}

	.arrow {
		font-size: 0.8em;
		opacity: 0.7;
		transition: transform 0.3s ease, opacity 0.3s ease;
		display: inline-block;
		margin-left: 0.2em;
	}

	.dropdown:hover .arrow {
		transform: rotate(180deg);
		opacity: 1;
	}

	.dropdown-content {
		position: absolute;
		top: 100%;
		left: 0;
		background: white;
		min-width: 220px;
		box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
		border-radius: 12px;
		border: 1px solid #e5e7eb;
		opacity: 0;
		visibility: hidden;
		transform: translateY(-8px);
		transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
		pointer-events: none;
		z-index: 10001;
		overflow: hidden;
		display: block;
	}

	.dropdown:hover .dropdown-content {
		opacity: 1;
		visibility: visible;
		transform: translateY(0);
		pointer-events: auto;
	}

	.dropdown-content a {
		display: block;
		padding: 14px 20px;
		color: #374151;
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-size: 0.95rem;
		font-weight: 500;
		transition: all 0.2s ease;
		border-bottom: 1px solid #f3f4f6;
		position: relative;
	}

	.dropdown-content a:last-child {
		border-bottom: none;
	}

	.dropdown-content a:hover {
		background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
		color: var(--accent);
		padding-left: 24px;
	}

	.dropdown-content a:hover::before {
		content: '';
		position: absolute;
		left: 0;
		top: 0;
		bottom: 0;
		width: 3px;
		background: var(--accent);
	}

	/* Active dropdown state */
	.dropdown:hover a {
		color: var(--accent);
		border-bottom-color: var(--accent);
		font-weight: 700;
	}


	.header-right {
		display: flex;
		align-items: center;
		gap: 1.5rem;
		height: 55px;
		margin-left: 1rem;
	}

	.phone-number a {
		color: var(--accent);
		text-decoration: none;
		font-family: "IBM Plex Sans", sans-serif;
		font-weight: 500;
		font-size: 1.1rem;
		transition: color 0.3s ease;
		padding: 0.7em 0.8em;
		display: flex;
		align-items: center;
		height: 55px;
		border-bottom: 4px solid transparent;
	}

	.phone-number a:hover {
		color: var(--accent);
		border-bottom-color: var(--accent);
		font-weight: 700;
	}

	.language-switcher {
		display: flex;
		border: 1px solid #d0d0d0;
		border-radius: 0;
		overflow: hidden;
		background: white;
	}

	.lang-button {
		background: white;
		border: none;
		padding: 0.5rem 0.8rem;
		font-family: "IBM Plex Sans", sans-serif;
		font-size: 0.8rem;
		cursor: pointer;
		transition: all 0.3s ease;
		color: #666;
		font-weight: 500;
		border-right: 1px solid #d0d0d0;
	}

	.lang-button:last-child {
		border-right: none;
	}

	.lang-button.active {
		background: var(--accent);
		color: white;
		font-weight: 600;
	}

	.lang-button:hover:not(.active) {
		background: #f5f5f5;
		color: var(--accent);
	}

	/* Tablet styles (iPad) */
	@media (max-width: 1024px) and (min-width: 721px) {
		nav {
			height: 36px;
			padding: 0.2rem 1rem;
		}

		.logo-image {
			height: 18px;
			max-width: 70px;
			transform: translateY(-3px);
		}

		.internal-links {
			gap: 0.2rem;
			align-items: center;
			margin-right: 1.5rem;
		}

		nav a {
			padding: 0.3em 0.2em;
			font-size: 0.75rem;
			display: flex;
			align-items: center;
			height: 32px;
		}

		.dropdown {
			display: flex;
			align-items: center;
		}

		.dropdown a {
			height: 32px;
			font-size: 0.75rem;
			padding: 0.3em 0.2em;
		}

		.phone-number {
			display: flex;
			align-items: center;
			height: 32px;
		}

		.phone-number a {
			font-size: 0.75rem;
			display: flex;
			align-items: center;
			height: 32px;
			padding: 0.3em 0.2em;
		}

		.lang-button {
			padding: 0.2rem 0.28rem;
			font-size: 0.44rem;
			height: 22px;
			display: flex;
			align-items: center;
		}

		.header-right {
			gap: 0.7rem;
			align-items: center;
		}

		.desktop-nav {
			align-items: center;
		}

		/* Enable dropdowns in tablet view */
		.dropdown:hover .dropdown-content {
			opacity: 1;
			visibility: visible;
			transform: translateY(0);
			pointer-events: auto;
		}
	}

	@media (max-width: 720px) {
		header {
			width: 100vw;
			max-width: 100vw;
			overflow-x: hidden;
		}

		nav {
			width: 100%;
			max-width: 100vw;
			padding: 0.4rem 1rem;
		}

		.nav-content {
			justify-content: flex-start;
			width: 100%;
			max-width: 100vw;
		}

		.desktop-nav {
			display: none;
		}

		.mobile-menu-toggle {
			display: flex;
		}

		.logo-image {
			height: 35px;
			transform: translateY(-2px) translateX(0px);
		}

		.mobile-nav {
			top: 57px;
		}
	}
</style>


<script>
// Language Switcher Script
class LanguageSwitcher {
  constructor() {
    this.currentLanguage = this.getStoredLanguage() || 'de';
    this.translations = null;
    this.init();
  }

  init() {
    this.translations = this.loadTranslations();
    this.setupEventListeners();
    this.updateLanguage(this.currentLanguage);
  }

  loadTranslations() {
    // Use inline translations with all available keys
    return this.getInlineTranslations();
  }

  getInlineTranslations() {
    return {
      de: {
        // Navigation
        home: "Home",
        clientArea: "Mandantenbereich",
        about: "Über Uns",
        meetTheTeam: "Meet the Team",
        references: "Referenzen",
        ourTraining: "Unsere Weiterbildungen",
        services: "Leistungen",
        individuals: "Privatpersonen",
        entrepreneurs: "Unternehmer",
        career: "Karriere",
        contact: "Kontakt",
        news: "Aktuelles",
        datevNews: "Datev News",
        downloads: "Downloads",
        taxVideos: "Steuererklärvideos",
        
        // Meet The Team translations
        teamHeroTitle: "Meet The Team",
        teamHeroSubtitle: "Lernen Sie unser kompetentes Team kennen",
        teamLeadershipTitle: "Kanzleileitung",
        teamLeaderName: "Burghard Heilgendorff",
        teamLeaderTitle: "Diplom-Kaufmann & Steuerberater",
        teamLeaderRole: "Kanzleiinhaber",
        teamLeaderDescription1: "Mit über 20 Jahren Erfahrung in der Steuerberatung leitet Burghard Heilgendorff unser Steuerbüro mit Leidenschaft und Kompetenz.",
        teamLeaderDescription2: "Sein umfassendes Fachwissen und seine persönliche Herangehensweise machen ihn zu einem vertrauensvollen Partner für unsere Mandanten.",
        teamSectionTitle: "Unsere Steuerberater",
        teamIntro: "Unser erfahrenes Team aus qualifizierten Steuerberatern steht Ihnen mit Fachkompetenz und Engagement zur Seite.",
        teamDescription1: "Gemeinsam bilden wir ein starkes Team, das sich durch langjährige Erfahrung und kontinuierliche Weiterbildung auszeichnet.",
        teamDescription2: "Wir arbeiten Hand in Hand, um für jeden Mandanten die bestmögliche steuerliche Beratung und Betreuung zu gewährleisten.",
        teamImageTitle: "Unser Team",
        teamImageSubtitle: "Gemeinsam für Ihren Erfolg",
      },
      en: {
        // Navigation
        home: "Home",
        clientArea: "Client Area",
        about: "About Us",
        meetTheTeam: "Meet the Team",
        references: "References",
        ourTraining: "Our Training",
        services: "Services",
        individuals: "Individuals",
        entrepreneurs: "Entrepreneurs",
        career: "Career",
        contact: "Contact",
        news: "News",
        datevNews: "Datev News",
        downloads: "Downloads",
        taxVideos: "Tax Declaration Videos",
        
        // Meet The Team translations
        teamHeroTitle: "Meet The Team",
        teamHeroSubtitle: "Get to know our competent team",
        teamLeadershipTitle: "Office Management",
        teamLeaderName: "Burghard Heilgendorff",
        teamLeaderTitle: "Diploma in Business Administration & Tax Advisor",
        teamLeaderRole: "Office Owner",
        teamLeaderDescription1: "With over 20 years of experience in tax consulting, Burghard Heilgendorff leads our tax office with passion and competence.",
        teamLeaderDescription2: "His comprehensive expertise and personal approach make him a trustworthy partner for our clients.",
        teamSectionTitle: "Our Tax Advisors",
        teamIntro: "Our experienced team of qualified tax advisors is at your side with expertise and commitment.",
        teamDescription1: "Together we form a strong team that is characterized by many years of experience and continuous training.",
        teamDescription2: "We work hand in hand to ensure the best possible tax advice and support for every client.",
        teamImageTitle: "Our Team",
        teamImageSubtitle: "Together for Your Success",
      }
    };
  }

  getStoredLanguage() {
    return localStorage.getItem('preferred-language');
  }

  setStoredLanguage(language) {
    localStorage.setItem('preferred-language', language);
  }

  setupEventListeners() {
    const deButtons = document.querySelectorAll('[data-lang="de"]');
    const enButtons = document.querySelectorAll('[data-lang="en"]');
    
    deButtons.forEach(button => {
      button.addEventListener('click', () => this.switchLanguage('de'));
    });
    
    enButtons.forEach(button => {
      button.addEventListener('click', () => this.switchLanguage('en'));
    });
  }

  switchLanguage(language) {
    this.currentLanguage = language;
    this.setStoredLanguage(language);
    this.updateLanguage(language);
  }

  updateLanguage(language) {
    if (!this.translations || !this.translations[language]) {
      console.error('Translations not available for language:', language);
      return;
    }

    const elements = document.querySelectorAll('[data-translate]');
    
    elements.forEach(element => {
      const key = element.getAttribute('data-translate');
      if (this.translations[language][key]) {
        element.textContent = this.translations[language][key];
      }
    });

    // Update active language button
    this.updateActiveLanguageButton(language);
  }

  updateActiveLanguageButton(language) {
    const deButtons = document.querySelectorAll('[data-lang="de"]');
    const enButtons = document.querySelectorAll('[data-lang="en"]');
    
    // Remove active class from all buttons
    deButtons.forEach(button => button.classList.remove('active'));
    enButtons.forEach(button => button.classList.remove('active'));
    
    // Add active class to the correct buttons
    if (language === 'de') {
      deButtons.forEach(button => button.classList.add('active'));
    } else {
      enButtons.forEach(button => button.classList.add('active'));
    }
  }
}

// Initialize the language switcher when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
  new LanguageSwitcher();
});

	document.addEventListener('DOMContentLoaded', function() {
		const mobileMenuToggle = document.getElementById('mobileMenuToggle');
		const mobileNav = document.getElementById('mobileNav');
		const mobileDropdowns = document.querySelectorAll('.mobile-dropdown');

		// Toggle mobile menu
		if (mobileMenuToggle && mobileNav) {
			mobileMenuToggle.addEventListener('click', function(e) {
				e.stopPropagation();
				mobileMenuToggle.classList.toggle('active');
				mobileNav.classList.toggle('active');
			});

			// Close mobile menu when clicking outside
			document.addEventListener('click', function(e) {
				if (!mobileMenuToggle.contains(e.target) && !mobileNav.contains(e.target)) {
					mobileMenuToggle.classList.remove('active');
					mobileNav.classList.remove('active');
				}
			});

			// Mobile dropdown functionality
			mobileDropdowns.forEach(dropdown => {
				const toggle = dropdown.querySelector('.mobile-dropdown-toggle');
				
				if (toggle) {
					toggle.addEventListener('click', function(e) {
						e.stopPropagation();
						dropdown.classList.toggle('active');
					});
				}
			});

			// Close mobile menu when clicking on a link
			const mobileLinks = document.querySelectorAll('.mobile-link');
			mobileLinks.forEach(link => {
				link.addEventListener('click', function() {
					mobileMenuToggle.classList.remove('active');
					mobileNav.classList.remove('active');
				});
			});
		}
	});
</script>
